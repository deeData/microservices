@model List<LedgerItemDto>
@using System.Text.Json;
@{
    Layout = "~/Views/Shared/_LayoutPayment.cshtml";
    var myModel = JsonSerializer.Serialize(Model);
}

@section Styles{
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css" />
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css" />
}


    <table id="dataTable" class="table table-responsive table-striped table-bordered table-hover" data-s>
        <thead>
            <tr>
                <th data-field="Posted">Posted</th>
                <th data-field="Description">Billing Entry</th>
                <th data-field="Debit" data-formatter="currencyFormat">Debit</th>
                <th data-field="Credit" data-formatter="currencyFormat">Credit</th>
                <th data-formatter="getBalance">Adjusted Balance</th>
                <th data-field="Remarks">Remarks</th>
            </tr>
        </thead>
    </table>

@section Scripts{

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
    <script>

        var currencyFormatter = new Intl.NumberFormat('en-US', {
            style: 'currency',
            currency: 'USD',
        });

        var format = function (data) {
            return currencyFormatter.format(data);
        }

        var currencyFormat = function (column, row, index) {
            return format(column);
        }

        var s = `@Html.Raw(myModel)`;
        var jsonData = JSON.parse(s);

        var runningTotal = 0;
        //goes through every preceding row
        var getBalance = function (column, row, index) {
            runningTotal += row.Debit;
            runningTotal += row.Credit;
            return format(runningTotal);
        }

        $(document).ready(function () {
            var $table = $('#dataTable')
            $table.bootstrapTable({
                data: jsonData
            });
            $table.dataTable();
        });

    </script>




}
